<!DOCTYPE html>
<html lang="en">
<head>
    <title>Thirty Days</title>
    <meta charset="utf-8"/>
    <style>
        table {
            text-align: center;
            border-collapse: collapse;
        }

        th, td {
            min-width: 20px;
            border: 1px solid black;
        }

        td:first-child {
            text-align: right;
            white-space: nowrap;
            padding-left: 10px;
            padding-right: 10px;
        }
    </style>
</head>
<body>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script>
    function doit(type, fn) {
        const elt = document.getElementById('data-table');
        const wb = XLSX.utils.table_to_book(elt, {sheet: "Sheet JS"});
        return XLSX.writeFile(wb, fn || ('thirty-days.xlsx'));
    }
</script>

<canvas id="myChart"></canvas>
<script>
var ctx = document.getElementById('myChart').getContext('2d');
var chart = new Chart(ctx, {
    type: 'line',

    data: {
        labels: {{ label }},
        datasets: [{
            backgroundColor: 'rgba(0, 185, 0, 0.3)',
            borderColor: 'rgb(0, 185, 0)',
            data: {{ chart }}
        }]
    },

    options: {
        legend: {
            display: false,
        }
    }
});
</script>

<div id="container"></div>
<script type="text/javascript">
    const ws = XLSX.utils.aoa_to_sheet({{ table | safe }});
    const html_string = XLSX.utils.sheet_to_html(ws, {id: "data-table"});
    document.getElementById("container").innerHTML = html_string;
</script>
<br>
<input type="submit" value="Export to XLSX!" onclick="doit('xlsx');">
</body>
</html>